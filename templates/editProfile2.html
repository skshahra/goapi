<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" href="./favicon.ico" />
    <title>Edit Profile</title>
</head>

<body>
    <div class="flex flex-col justify-center items-center w-full ">
        <h1 class="text-3xl font-bold mb-5">
            Edit Your Profile , {{.Firstname}} {{.Lastname}}
        </h1>

        <!-- Created with Inkscape (http://www.inkscape.org/) -->

        <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#"
            xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg"
            xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
            xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="256" height="256" id="svg2"
            version="1.1" inkscape:version="0.91 r" sodipodi:docname="client.svg"
            inkscape:export-filename="C:\Users\julio\Desktop\sistemas\sistemas\desarrollo\cartonnet\arte\iconpack\client.png"
            inkscape:export-xdpi="35.630001" inkscape:export-ydpi="35.630001">
            <defs id="defs4">
                <clipPath id="clipPath5383" clipPathUnits="userSpaceOnUse">
                    <path id="path5385" d="m 24.3333,46.0004 26.1669,0 0,-23.0004 -26.1669,0 0,23.0004 z"
                        inkscape:connector-curvature="0" />
                </clipPath>
                <clipPath id="clipPath5359" clipPathUnits="userSpaceOnUse">
                    <path id="path5361" d="m 18,43 28,0 0,-28 -28,0 0,28 z" inkscape:connector-curvature="0" />
                </clipPath>
                <clipPath id="clipPath5347" clipPathUnits="userSpaceOnUse">
                    <path id="path5349" d="M 0,64 64,64 64,0 0,0 0,64 Z" inkscape:connector-curvature="0" />
                </clipPath>
                <clipPath id="clipPath5478" clipPathUnits="userSpaceOnUse">
                    <path id="path5480" d="m 24.3333,46.0004 26.1669,0 0,-23.0004 -26.1669,0 0,23.0004 z"
                        inkscape:connector-curvature="0" />
                </clipPath>
                <clipPath id="clipPath5454" clipPathUnits="userSpaceOnUse">
                    <path id="path5456" d="m 18,43 28,0 0,-28 -28,0 0,28 z" inkscape:connector-curvature="0" />
                </clipPath>
                <clipPath id="clipPath5442" clipPathUnits="userSpaceOnUse">
                    <path id="path5444" d="M 0,64 64,64 64,0 0,0 0,64 Z" inkscape:connector-curvature="0" />
                </clipPath>
                <clipPath id="clipPath5549" clipPathUnits="userSpaceOnUse">
                    <path id="path5551" d="m 12.2873,54 39.4254,0 0,-48 -39.4254,0 0,48 z"
                        inkscape:connector-curvature="0" />
                </clipPath>
                <clipPath id="clipPath5537" clipPathUnits="userSpaceOnUse">
                    <path id="path5539" d="M 0,64 64,64 64,0 0,0 0,64 Z" inkscape:connector-curvature="0" />
                </clipPath>
                <clipPath id="clipPath3416" clipPathUnits="userSpaceOnUse">
                    <path inkscape:connector-curvature="0" id="path3418" d="M 0,64 64,64 64,0 0,0 0,64 Z" />
                </clipPath>
                <clipPath id="clipPath3428" clipPathUnits="userSpaceOnUse">
                    <path inkscape:connector-curvature="0" id="path3430"
                        d="m 9,44.3637 46,0 L 55,16 9,16 9,44.3637 Z" />
                </clipPath>
            </defs>
            <sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0"
                inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4479167" inkscape:cx="49.074498"
                inkscape:cy="44.010785" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false"
                showborder="true" inkscape:window-width="1366" inkscape:window-height="716" inkscape:window-x="-8"
                inkscape:window-y="22" inkscape:window-maximized="1" />
            <metadata id="metadata7">
                <rdf:RDF>
                    <cc:Work rdf:about="">
                        <dc:format>image/svg+xml</dc:format>
                        <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
                        <dc:title></dc:title>
                    </cc:Work>
                </rdf:RDF>
            </metadata>
            <g inkscape:label="Capa 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-796.3622)">
                <g id="g3362" transform="matrix(5.3333333,0,0,5.3333333,0,-4560.2362)">
                    <path inkscape:connector-curvature="0"
                        d="m 48,1028.3622 c 0,13.2548 -10.74525,24 -24,24 -13.25475,0 -24,-10.7452 -24,-24 0,-13.2547 10.74525,-24 24,-24 13.25475,0 24,10.7453 24,24"
                        style="
                fill: #76c2af;
                fill-opacity: 1;
                fill-rule: nonzero;
                stroke: none;
              " id="path5543" />
                    <g transform="matrix(0.75,0,0,-0.75,0,1052.3622)" id="g5547" />
                    <g transform="matrix(0.75,0,0,-0.75,0,1052.3622)" id="g5553">
                        <g style="opacity: 0.19999701" clip-path="url(#clipPath5549)" id="g5555">
                            <g transform="translate(43.9048,16.457)" id="g5557" />
                        </g>
                    </g>
                    <path inkscape:connector-curvature="0" id="path4303" transform="translate(0,1004.3622)"
                        d="m 23.474609,5.8710938 c -4.672555,0 -8.459001,3.7863843 -8.458984,8.4589842 3e-6,0.8149 0.379751,3.087603 1.201172,4.345703 0,0 3.086104,2.822969 7.25,6.541016 -3.653525,0.02761 -7.625454,0.04392 -10.644531,2.029297 -2.147453,1.4123 -3.768058,3.902628 -4.2675785,6.423828 -0.3950273,1.9938 -1.9711036,4.449169 1.1835937,5.980469 1.2895508,0.625911 5.6516558,4.150193 10.6542968,8.078125 C 21.569556,47.905992 22.773524,48 24,48 36.736974,48 47.15069,38.0756 47.945312,25.539062 38.86939,16.79164 27.410156,6.8398438 27.410156,6.8398438 26.2326,6.1783437 24.18889,5.8710938 23.474609,5.8710938 Z"
                        style="
                opacity: 1;
                fill: #000000;
                fill-opacity: 0.19607843;
                stroke: none;
                stroke-width: 1;
                stroke-miterlimit: 4;
                stroke-dasharray: none;
                stroke-opacity: 1;
              " />
                    <circle r="8.4604311" cy="1018.6931" cx="23.475243" id="path4290" style="
                opacity: 1;
                fill: #ffffff;
                fill-opacity: 1;
                stroke: none;
                stroke-width: 1;
                stroke-miterlimit: 4;
                stroke-dasharray: none;
                stroke-opacity: 1;
              " />
                    <path sodipodi:nodetypes="asssaaaaa" inkscape:connector-curvature="0" id="circle4294"
                        d="m 39.604738,1038.0312 c 0.319987,2.0158 1.700566,4.4269 -1.386392,5.9641 -3.086958,1.5371 -9.299315,2.4964 -14.138787,2.4964 -4.839472,0 -11.187308,-0.9475 -14.3420049,-2.4787 -3.1546973,-1.5313 -1.5782008,-3.988 -1.1831735,-5.9818 0.4995205,-2.5212 2.1197664,-5.0099 4.2672194,-6.4222 3.186388,-2.0954 7.444473,-2.0018 11.257959,-2.0382 3.896665,-0.037 8.311337,-0.3174 11.541153,1.8629 2.129303,1.4373 3.581256,4.0602 3.984026,6.5975 z"
                        style="
                opacity: 1;
                fill: #ffffff;
                fill-opacity: 1;
                stroke: none;
                stroke-width: 1;
                stroke-miterlimit: 4;
                stroke-dasharray: none;
                stroke-opacity: 1;
              " />
                    <path inkscape:connector-curvature="0"
                        d="m 24,1046.2671 -3.367641,-4.7756 3.367641,-8.058 3.367641,8.058 z m 0,-11.9648 -3.367641,-4.7756 6.735282,0 z"
                        style="
                opacity: 1;
                fill: #4f5d73;
                fill-opacity: 1;
                stroke: none;
                stroke-width: 1;
                stroke-miterlimit: 4;
                stroke-dasharray: none;
                stroke-opacity: 1;
              " id="path4314" />
                </g>
            </g>
        </svg>

        <div class="flex justify-center">
            <div class="mb-3 xl:w-96">
                <label class="form-label inline-block mb-2 text-gray-700">First Name:
                </label>
                <input type="text" class="
          form-control
          block
          w-full
          px-3
          py-1.5
          text-base
          font-normal
          text-gray-700
          bg-white bg-clip-padding
          border border-solid border-gray-300
          rounded
          transition
          ease-in-out
          m-0
          focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none
        " id="myFirstname" placeholder="First Name" />
            </div>
        </div>

        <div class="flex justify-center">
            <div class="mb-3 xl:w-96">
                <label class="form-label inline-block mb-2 text-gray-700">Last Name:
                </label>
                <input type="text" class="
          form-control
          block
          w-full
          px-3
          py-1.5
          text-base
          font-normal
          text-gray-700
          bg-white bg-clip-padding
          border border-solid border-gray-300
          rounded
          transition
          ease-in-out
          m-0
          focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none
        " id="myLastname" placeholder="Last Name" />
            </div>
        </div>

        <div class="flex justify-center">
            <div class="mb-3 xl:w-96">
                <label class="form-label inline-block mb-2 text-gray-700">Email Address:
                </label>
                <input type="email" class="
          form-control
          block
          w-full
          px-3
          py-1.5
          text-base
          font-normal
          text-gray-700
          bg-white bg-clip-padding
          border border-solid border-gray-300
          rounded
          transition
          ease-in-out
          m-0
          focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none
          " id="myEmail" placeholder="Email" />
            </div>
        </div>
        <div class="flex justify-center">
            <div class="mb-3 xl:w-96">
                <label class="form-label inline-block mb-2 text-gray-700">Passowrd :
                </label>
                <input type="text" class="
          form-control
          block
          w-full
          px-3
          py-1.5
          text-base
          font-normal
          text-gray-700
          bg-white bg-clip-padding
          border border-solid border-gray-300
          rounded
          transition
          ease-in-out
          m-0
          focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none
          " id="myPassword" placeholder="Password" />
            </div>
        </div>
    </div>
    <div class="flex justify-center">
        <div class="mb-3 xl:w-96">
            <label class="form-label inline-block mb-2 text-gray-700">Authenticated Using Google:
            </label>
            <div
                class="form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none">
                <p class="">{{.GoogleAuth}}</p>
            </div>
        </div>
    </div>
    </div>
    </div>
    <div class="flex justify-center">
        <div class="mb-3 xl:w-96">
            <label class="form-label inline-block mb-2 text-gray-700">Telephone :
            </label>
            <div
                class="form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none">
                <input type="text" class="
          form-control
          block
          w-full
          px-3
          py-1.5
          text-base
          font-normal
          text-gray-700
          bg-white bg-clip-padding
          border border-solid border-gray-300
          rounded
          transition
          ease-in-out
          m-0
          focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none
        " id="myTelephone" placeholder="Telephone" />
            </div>

        </div>
    </div>
    </div>
    <div class="flex justify-center">
        <div class="mb-3 xl:w-96">
            <label class="form-label inline-block mb-2 text-gray-700">Address :
            </label>
            <div
                class="form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none">
                <input type="text" class="
          form-control
          block
          w-full
          px-3
          py-1.5
          text-base
          font-normal
          text-gray-700
          bg-white bg-clip-padding
          border border-solid border-gray-300
          rounded
          transition
          ease-in-out
          m-0
          focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none
        " id="myAddress" placeholder="Address" />
            </div>
        </div>
    </div>
    </div>
    <div id="errormsg" class="">Error Message</div>
    <div class="flex flex-row justify-center mb-10">
        <button onclick="updateProfile()"
            class="inline-block px-6 py-2.5 text-black font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out">
            Update Profile
        </button>

        <a href="/"
            class="inline-block px-6 py-2.5 text-black font-medium text-xs text-red-600 leading-tight uppercase rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out">
            Cancel
        </a>
    </div>
    </div>
    <script>
        document.getElementById("errormsg").style.visibility = "hidden";

        document.getElementById("myFirstname").value = "{{.Firstname}}";
        document.getElementById("myLastname").value = "{{.Lastname}}";
        document.getElementById("myEmail").value = "{{.Email}}";
        "{{if .GoogleAuth}}";
        document.getElementById("myEmail").disabled = true;
        document.getElementById("myPassword").disabled = true;
        document.getElementById("myPassword").placeholder = "•••••••••••";
        "{{else}}";
        document.getElementById("myPassword").disabled = false;
        document.getElementById("myPassword").placeholder = "{{.Password}}}}";
        "{{end}}";
        document.getElementById("myTelephone").value = "{{.Telephone}}";
        document.getElementById("myAddress").value = "{{.Address}}";
        // document.getElementById("myFirstname").value = "{{.Firstname}}";
        // document.getElementById("myFirstname").value = "{{.Firstname}}";

        const ValidateEmail = (E) => {
        return String(E)
          .toLowerCase()
          .match(
            /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
          );
      };
      function ValidateName(e) {
        return e.match(/^[a-zA-Z\s]*$/);
      }

      document.getElementById("errormsg").style.visibility = "hidden";
      let updatedData = {
        firstname: "",
        lastname: "",
        email: "",
        password: "",
        telephone: "",
        address: "",
      };
      function updateProfile() {
        document.getElementById("errormsg").style.visibility = "hidden";

        updatedData.firstname = document
          .getElementById("myFirstname")
          .value.trim();
        updatedData.lastname = document
          .getElementById("myLastname")
          .value.trim();
        updatedData.email = document.getElementById("myEmail").value.trim();
        updatedData.password = document.getElementById("myPassword").value;
        updatedData.telephone = document.getElementById("myTelephone").value;
        updatedData.address = document.getElementById("myAddress").value;
        console.log("🚀 updatedData : ", updatedData);
        if (updatedData.firstname.trim() == "") {
          document.getElementById("errormsg").style.visibility = "visible";
          document.getElementById("errormsg").innerHTML =
            "First Name is required";
          document.getElementById("errormsg").style.display = "block";
          return;
        }
        if (updatedData.firstname.length < 2) {
          document.getElementById("errormsg").style.visibility = "visible";

          document.getElementById("errormsg").innerHTML =
            "First name have to be at least 2 characters";
          document.getElementById("errormsg").style.display = "block";
          return;
        }
        if (!ValidateName(updatedData.firstname)) {
          document.getElementById("errormsg").style.visibility = "visible";

          document.getElementById("errormsg").innerHTML =
            "First name is not valid";
          document.getElementById("errormsg").style.display = "block";
          return;
        }

        if (updatedData.lastname.trim() == "") {
          document.getElementById("errormsg").style.visibility = "visible";

          document.getElementById("errormsg").innerHTML =
            "Last Name is required";
          document.getElementById("errormsg").style.display = "block";
          return;
        }
        if (updatedData.lastname.length < 2) {
          document.getElementById("errormsg").style.visibility = "visible";

          document.getElementById("errormsg").innerHTML =
            "Last Name have to be at least 2 characters";
          document.getElementById("errormsg").style.display = "block";
          return;
        }
        if (!ValidateName(updatedData.lastname)) {
          document.getElementById("errormsg").style.visibility = "visible";

          document.getElementById("errormsg").innerHTML =
            "last name is not valid";
          document.getElementById("errormsg").style.display = "block";
          return;
        }
        if (updatedData.email.trim() == "") {
          document.getElementById("errormsg").style.visibility = "visible";

          document.getElementById("errormsg").innerHTML = "Email is required";
          document.getElementById("errormsg").style.display = "block";
          return;
        }
        if (!ValidateEmail(updatedData.email)) {
          document.getElementById("errormsg").style.visibility = "visible";

          document.getElementById("errormsg").innerHTML = "Email is not valid";
          document.getElementById("errormsg").style.display = "block";
          return;
        }
        "{{if .GoogleAuth}}"
        "{{else}}"
        if (updatedData.password == "" ) {
          document.getElementById("errormsg").style.visibility = "visible";

          document.getElementById("errormsg").innerHTML =
            "Password is not valid/required";
          document.getElementById("errormsg").style.display = "block";
          return;
        }
        if (updatedData.password.length < 6 ) {
          document.getElementById("errormsg").style.visibility = "visible";

          document.getElementById("errormsg").innerHTML =
            "Password is not strong";
          document.getElementById("errormsg").style.display = "block";
          return;
        }
        "{{end}}"


        fetch("/api/editprofile", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(updatedData),
        })
          .then((res) => res.json())
          .then((data) => {
            // console.log(data);
            window.location.href = "/";
          })
          .catch((err) => {
            document.getElementById("errormsg").style.visibility = "visible";

            document.getElementById("errormsg").innerHTML =
              "Update error, please try again";
            document.getElementById("errormsg").style.display = "block";
            return;
          });
        
    }


   
        // function updateProfile() {

        // }
    </script>
</body>

</html>